Kafka是一个高吞吐量的，手机网站动作流以及物联网设备的采样信息。

## 初识Kafka

流处理平台，消息订阅和发布。  解耦，异步通信，削峰，填谷

消息队列

流处理

### 消息队列

两大类

至多一次： 消费者消费之后，又消息服务器主动删除队列中的数据。消息队列的数据不允许重复消费。

没有限制： 消息可以被多个消费者同时消费。一个消费者可以多次消费消息服务器中同一条记录。

### 1.2.1   消息和批次

Kafka的数据单元被称为消息。

消息由字节数组组成。

record：  key/value/timestamp

消息会由键取模分区数，这样会被分到不同的分区



消息被分批次写入Kafka，批次就是一组消息，这组消息属于同一个主题和分区。

### 1.2.2   模式

### 1.2.3   主题和分区

Kafka的消息通过主题来分类。  主题可以被分到多个分区中。 一个分区就是一个提交日志。

一个主题被分到多个分区所以主题内无法保证消息的顺序性。但是分区内的消息是有序的，追加方式写入。

### 1.2.4   生产者和消费者

生产者     一个消息被发布到一个主题。  默认会把消息均匀的分到主题的所有分区。

通过消息键和分区器将其映射到指定的分区上。这样可以保证包含同一个键的消息会被写到
同一个分区上。生产者也可以使用自定义的分区器，根据不同的业务规则将消息映射到分区。



消费者    消费者可以订阅一个或者多个主题。并按照消息的生成顺序读取他们。

消费者通过偏移量来判断这个消息是否读取过。

偏移量是另一种元数据，他是一个不断递增的整数值，在创建消息的时候会把他添加到消息中。给定的分区中偏移量是唯一的。消费者把每个分区最后读取的消息偏移量保存在 Zookeeper 或 Kafka 上  如果消费者关闭或重启，它的读取状态不会丢失。  



消费者群组，就是一组消费者消费一个主题的所有分区。一个消费者挂了，其他人接手。